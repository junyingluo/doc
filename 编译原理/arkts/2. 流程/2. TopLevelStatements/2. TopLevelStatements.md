- 加载内置库

  - program 等于 ctx->parser->globalProgram\_

  ```c++
  bool TopLevelStatements::Perform(public_lib::Context *ctx, parser::Program *program)
  {
      auto imports = ImportExportDecls(program->VarBinder()->AsETSBinder(), ctx->parser->AsETSParser());
      imports.ParseDefaultSources();

      ......
  }
  ```

* ImportExportDecls

  生成如下代码，并保存到 defaultImportSource\_

  ```
  import * from "std/core";import * from "std/math";import * from "std/containers";import * from "std/time";import * from "std/interop/js";import * from "std/debug";import * from "std/debug/concurrency";import * from "std/testing";import * from "escompat";import * from "std/concurrency";import * from "std/annotations";
  ```

* ParseDefaultSources

  - ParseImportDeclarations 将 defaultImportSource* 转换为 ETSImportDeclaration 数组，保存到 varbinder*.defaultImports\_

  - ParseSources 解析外部文件并转换为 std::vector<Program\*>，并保存到 globalProgram*.externalSources*

  ```c++
  void ImportExportDecls::ParseDefaultSources()
  {
      auto imports = parser_->ParseDefaultSources(DEFAULT_IMPORT_SOURCE_FILE, defaultImportSource_);
      varbinder_->SetDefaultImports(std::move(imports));
  }
  ArenaVector<ir::ETSImportDeclaration *> ETSParser::ParseDefaultSources(std::string_view srcFile, std::string_view importSrc)
  {
      auto isp = InnerSourceParser(this);
      SourceFile source(srcFile, importSrc);
      auto lexer = InitLexer(source);

      Lexer()->NextToken();

      GetContext().Status() |= ParserStatus::IN_DEFAULT_IMPORTS;
      auto statements = ParseImportDeclarations();
      GetContext().Status() &= ~ParserStatus::IN_DEFAULT_IMPORTS;

      AddExternalSource(ParseSources());
      return statements;
  }
  ```

  - ModuleName：std/core、std/math

  ```c++
  void ETSParser::AddExternalSource(const std::vector<Program *> &programs)
  {
      auto &extSources = globalProgram_->ExternalSources();

      for (auto *newProg : programs) {
          const util::StringView name = newProg->ModuleName();
          if (extSources.count(name) == 0) {
              extSources.try_emplace(name, Allocator()->Adapter());
          }

          extSources.at(name).emplace_back(newProg);
      }
  }
  ```
