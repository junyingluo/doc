### 基本知识

- Opengl 设备空间，是 -1 到 1 之间的正方体

  - 在这个区间内的点才会被绘制，因此传给 Opengl 的坐标点必须在 -1 到 1 之间

  * **z 轴方向朝屏幕里，世界坐标系 z 轴方向屏幕外**

    ![alt text](../../3d/webgl/基本原理/assets/space.png)

- Opengl 设备空间的 x 和 y 轴组成的平面会映射到 gl.viewport(x, y, w, h)对应的区域

  ```js
  const canvas = document.getElementById("canvas");
  canvas.width = canvas.clientWidth * window.devicePixelRatio;
  canvas.height = canvas.clientHeight * window.devicePixelRatio;

  const gl = canvas.getContext("webgl");
  gl.viewport(0, 0, canvas.width, canvas.height);
  ```

* Opengl 是列向量，因此变换矩阵应该是**左乘**

* 矩阵变换发生在顶点着色器之前

### 变换流程

- 物体坐标 -> 世界坐标，平移缩放旋转变换

- 世界坐标 -> 相机坐标，即，相机变换

- 相机坐标 -> 设备空间，即，投影变换

### 世界坐标

- 平移变换，x 轴平移 a，y 轴平移 b，z 轴平移 z

  $$
  \begin{bmatrix}
  1 & 0 & 0 & a \\
  0 & 1 & 0 & b \\
  0 & 0 & 1 & c \\
  0 & 0 & 0 & 1
  \end{bmatrix}
  \begin{bmatrix}
  x \\ y \\ z \\ 1
  \end{bmatrix}
  =
  \begin{bmatrix}
  x+a \\ y+b \\ z+c \\ 1
  \end{bmatrix}
  $$

- 缩放变换：x 轴缩放 a 倍，y 轴缩放 b 倍，z 轴缩放 z 倍

  $$
  \begin{bmatrix}
  a & 0 & 0 & 0 \\
  0 & b & 0 & 0 \\
  0 & 0 & c & 0 \\
  0 & 0 & 0 & 1
  \end{bmatrix}
  \begin{bmatrix}
  x \\ y \\ z \\ 1
  \end{bmatrix}
  =
  \begin{bmatrix}
  ax \\ by \\ cz \\ 1
  \end{bmatrix}
  $$

- 旋转变换

### 相机变换

### 投影变换
