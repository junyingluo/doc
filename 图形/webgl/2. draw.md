### VBO (Vertex Buffer Object)

- VBO 为显卡一个高速缓存，用于存储顶点数据

* STATIC_DRAW 不会更改
* DYNAMIC_DRAW 经常更改
* STREAM_DRAW 每次绘制时都会改变

```js
const vertices = new Float32Array([0.0, 0.1, -0.1, -0.1, 0.1, -0.1]);
const vertexBuffer = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);
```

- createBuffer / deleteBuffer / bindBuffer / bufferData / isBuffer

### EBO (Element Buffer Object)

- EBO 为显卡一个高速缓存，用于存储顶点的索引

```js
const indices = new Uint8Array([0, 1, 2]);
const indexesBuffer = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indicesBuffer);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, indices, gl.STATIC_DRAW);
```

### 顶点数组

- 默认顶点属性为固定值，而不是数组，其通过 vertexAttrib[1234]f[v]() 相关方法来赋值

```js
const a_foobar = gl.getAttribLocation(shaderProgram, "foobar");
gl.vertexAttrib3f(a_foobar, 10.0, 5.0, 2.0);
```

- 如果想让顶点属性从 VBO 或 EBO 中读取数据，则需要调用 enableVertexAttribArray 来开启，通过 gl.vertexAttribPointer 设定读取方法

```js
const a_Position = gl.getAttribLocation(gl.program, "a_Position");
gl.vertexAttribPointer(a_Position, 2, gl.FLOAT, false, 0, 0);
gl.enableVertexAttribArray(a_Position);
```

- enableVertexAttribArray / disableVertexAttribArray

* vertexAttribPointer
  - index: attribute 变量的索引，由 getAttribLocation 获取
  - size: 每个顶点属性的分量数，例如，size 为 3，表示每个点占 3 个数据
  - type: 数据类型
    - gl.FLOAT（4 字节）
    - gl.UNSIGNED_BYTE（1 字节）
    - gl.UNSIGNED_SHORT（2 字节）
  - normalized: 是否归一化（仅整数有效）
  - stride: 步长
    - 0 ：表示顶点数据 “紧密排列”（无间隔），GPU 会自动按 size \* 字节数计算步长
  - offset: 偏移量

### drawArrays

- mode
  - gl.TRIANGLES 画三角形
- offset：从 vbo 中第几个点开始读取
- count：表示点的个数

```js
const vertices = new Float32Array([0.0, 0.1, -0.1, -0.1, 0.1, -0.1]);
const vertexBuffer = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);
gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);

const a_Position = gl.getAttribLocation(gl.program, "a_Position");
gl.vertexAttribPointer(a_Position, 2, gl.FLOAT, false, 0, 0);
gl.enableVertexAttribArray(a_Position);

gl.drawArrays(gl.TRIANGLES, 0, 3);
```

### drawElements

```js
const vertices = new Float32Array([
  -0.5, 0.5, 0.0, -0.5, -0.5, 0.0, 0.5, -0.5, 0.0,
]);
const indices = new Uint16Array([0, 1, 2]);

const vbo = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, vbo);
gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);

const ebo = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ebo);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, indices, gl.STATIC_DRAW);

const positionAttribLocation = gl.getAttribLocation(program, "a_position");

const stride = 3 * Float32Array.BYTES_PER_ELEMENT;

gl.vertexAttribPointer(positionAttribLocation, 3, gl.FLOAT, false, stride, 0);
gl.enableVertexAttribArray(positionAttribLocation);

gl.drawElements(gl.TRIANGLES, indices.length, gl.UNSIGNED_SHORT, 0);
```
