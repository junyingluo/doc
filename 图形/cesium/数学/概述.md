### 视图矩阵

- 又称相机矩阵

* camera.viewMatrix

```js
Object.defineProperties(Camera.prototype, {
  viewMatrix: {
    get: function () {
      updateMembers(this);
      return this._viewMatrix;
    },
  }
}
UniformState.prototype.updateCamera = function (camera) {
  setView(this, camera.viewMatrix);
  ......
};
function setView(uniformState, matrix) {
  Matrix4.clone(matrix, uniformState._view);
  .....
}
```

### 模型矩阵

- drawCommand.\_modelMatrix

```js
function continueDraw(context, drawCommand, shaderProgram, uniformMap) {
  context._us.model = drawCommand._modelMatrix ?? Matrix4.IDENTITY;
  shaderProgram._setUniforms(
    uniformMap,
    context._us,
    context.validateShaderProgram,
  );
}
Object.defineProperties(UniformState.prototype, {
  model: {
    get: function () {
      return this._model;
    },
    set: function (matrix) {
      Matrix4.clone(matrix, this._model);
      ......
    },
  },
}
```

### 视图模型

```js
Object.defineProperties(UniformState.prototype, {
  modelView: {
    get: function () {
      cleanModelView(this);
      return this._modelView;
    },
  }
}
function cleanModelView(uniformState) {
  if (uniformState._modelViewDirty) {
    uniformState._modelViewDirty = false;

    Matrix4.multiplyTransformation(
      uniformState._view,
      uniformState._model,
      uniformState._modelView,
    );
  }
}
```

### 投影矩阵

- 默认

  ```js
  function Camera(scene) {
    this.frustum = new PerspectiveFrustum();
    this.frustum.aspectRatio =
      scene.drawingBufferWidth / scene.drawingBufferHeight;
    this.frustum.fov = CesiumMath.toRadians(60.0);
  }
  ```

- 设置

  ```js
  UniformState.prototype.updateCamera = function (camera) {
    setView(this, camera.viewMatrix);
    setInverseView(this, camera.inverseViewMatrix);
    setCamera(this, camera);

    this._entireFrustum.x = camera.frustum.near;
    this._entireFrustum.y = camera.frustum.far;
    this.updateFrustum(camera.frustum);

    this._orthographicIn3D =
      this._mode !== SceneMode.SCENE2D &&
      camera.frustum instanceof OrthographicFrustum;
  };
  UniformState.prototype.updateFrustum = function (frustum) {
    setProjection(this, frustum.projectionMatrix);
    ......
  };
  function setProjection(uniformState, matrix) {
    Matrix4.clone(matrix, uniformState._projection);
    ......
  }
  ```

- 读取

  ```js
  Object.defineProperties(UniformState.prototype, {
    projection: {
      get: function () {
        return this._projection;
      },
    }
  }
  const AutomaticUniforms = {
    czm_projection: new AutomaticUniform({
      size: 1,
      datatype: WebGLConstants.FLOAT_MAT4,
      getValue: function (uniformState) {
        return uniformState.projection;
      },
    }),
  }
  ```
