### 罗德里格斯公式

<img src="assets/2.1 绕轴/gl_rotate.png" width="30%" height="30%" />

* 设向量 $\vec{p}$ 绕单位向量 $\vec{r}$ 轴旋转 $\theta$ 变成 $\vec{q}$

  $$
  \begin{aligned}
  \vec{q} &= \overrightarrow{OR} + \overrightarrow{RQ} \\
  &= \overrightarrow{OR} + \cos\theta\,\overrightarrow{RP} + \sin\theta\,\overrightarrow{RS} \\
  &= \overrightarrow{OR} + \cos\theta\,\overrightarrow{RP} + \sin\theta\,(\vec{r} \times \vec{p})
      &&(\because \overrightarrow{RQ} = \cos\theta\,\overrightarrow{RP} + \sin\theta\,(\vec{r} \times \vec{p})) \\
  &= \overrightarrow{OR} + \cos\theta\,(\vec{p} - \overrightarrow{OR}) + \sin\theta\,(\vec{r} \times \vec{p})
      &&(\because \vec{p} = \overrightarrow{OR} + \overrightarrow{RP}) \\
  &= (1 - \cos\theta)\,\overrightarrow{OR} + \cos\theta\,\vec{p} + \sin\theta\,(\vec{r} \times \vec{p}) \\
  &= (1 - \cos\theta)\,(\vec{p} \cdot \vec{r})\,\vec{r} + \cos\theta\,\vec{p} + \sin\theta\,(\vec{r} \times \vec{p})
      &&(\because \overrightarrow{OR} = (\vec{p} \cdot \vec{r})\,\vec{r})
  \end{aligned}
  $$

- 设旋转轴为 $\vec{r}$，旋转角为 $\theta$，则旋转矩阵为

$$
M_R = \begin{pmatrix}
(1 - c)x^2 + c & (1 - c)xy - sz & (1 - c)xz + sy & 0 \\
(1 - c)xy + sz & (1 - c)y^2 + c & (1 - c)yz - sx & 0 \\
(1 - c)xz - sy & (1 - c)yz + sx & (1 - c)z^2 + c & 0 \\
0 & 0 & 0 & 1
\end{pmatrix}
$$

$$
\text{where } c = \cos\theta,\quad s = \sin\theta,\quad \vec{r} = (x,y,z)
$$